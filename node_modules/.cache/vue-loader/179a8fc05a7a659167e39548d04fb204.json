{"remainingRequest":"C:\\Users\\windows\\Project\\toutiaomobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\windows\\Project\\toutiaomobile\\src\\views\\home\\components\\channel-edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\windows\\Project\\toutiaomobile\\src\\views\\home\\components\\channel-edit.vue","mtime":1614944062014},{"path":"C:\\Users\\windows\\Project\\toutiaomobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\windows\\Project\\toutiaomobile\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\windows\\Project\\toutiaomobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\windows\\Project\\toutiaomobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyDov5nph4zlj6/ku6Xlr7zlhaXlhbbku5bmlofku7bvvIjmr5TlpoLvvJrnu4Tku7bvvIzlt6Xlhbdqc++8jOesrOS4ieaWueaPkuS7tmpz77yManNvbuaWh+S7tu+8jOWbvueJh+aWh+S7tuetieetie+8iQ0KaW1wb3J0IHsgY2hhbm5lbEFsbExpc3QsIGFkZFVzZXJDaGFubmVsLCBkZWxldGNVc2VyQ2hhbm5lbCB9IGZyb20gJ0AvYXBpL2NoYW5uZWwuanMnDQppbXBvcnQgeyBtYXBTdGF0ZSB9IGZyb20gJ3Z1ZXgnDQppbXBvcnQgeyBzZXRJdGVtIH0gZnJvbSAnQC91dGlscy9zdG9yYWdlJw0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7fSwNCiAgLy8g5a6a5LmJ5bGe5oCnDQogIHByb3BzOiB7DQogICAgbXlDaGFubmVsczogew0KICAgICAgdHlwZTogQXJyYXksDQogICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgIH0sDQogICAgbXlBY3RpdmU6IHsNCiAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfQ0KICB9LA0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgYWxsY2hhbm5lbHM6IFtdLCAvLyDmiYDmnInpopHpgZMNCiAgICAgIGlzZWRpdDogZmFsc2UsIC8vIOWIoOmZpOaMiemUrueahOaYvuekuuS4jumakOiXjw0KICAgICAgZml4SXRlbTogWzBdIC8vIOWbuuWumuS4jeimgeWIoOmZpOeahOmikemBkw0KICAgIH0NCiAgfSwNCiAgLy8g6K6h566X5bGe5oCn77yM5Lya55uR5ZCs5L6d6LWW5bGe5oCn5YC86ZqP5LmL5Y+Y5YyWDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwU3RhdGUoWyd1c2VyJ10pLA0KICAgIHJlY29tbWVuZENoYW5uZWxzICgpIHsNCiAgICAgIC8qIOaOqOiNkOmikemBk+aVsOaNriAqLw0KICAgICAgY29uc3QgY2hhbm5lbHMgPSBbXQ0KICAgICAgdGhpcy5hbGxjaGFubmVscy5mb3JFYWNoKGNoYW5uZWwgPT4gew0KICAgICAgICAvLyDpgY3ljobmiYDmnInpopHpgZPvvIzlubblsIblsZ7kuo7kuKrkurrpopHpgZPnmoTmlbDmja7liZTpmaTvvIzlubbov5Tlm57liankuIvnmoTpopHpgZMNCiAgICAgICAgY29uc3QgcmV0ID0gdGhpcy5teUNoYW5uZWxzLmZpbmQobXljaGFubmVsID0+IHsNCiAgICAgICAgICByZXR1cm4gbXljaGFubmVsLmlkID09PSBjaGFubmVsLmlkDQogICAgICAgIH0pDQogICAgICAgIGlmICghcmV0KSB7DQogICAgICAgICAgY2hhbm5lbHMucHVzaChjaGFubmVsKQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgICAgcmV0dXJuIGNoYW5uZWxzDQogICAgfQ0KICB9LA0KICAvLyDnm5HmjqdkYXRh5Lit55qE5pWw5o2u5Y+Y5YyWDQogIHdhdGNoOiB7fSwNCiAgLy8g5pa55rOV6ZuG5ZCIDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBsb2FkQWxsQ2hhbm5lbHMgKCkgew0KICAgICAgLyog6I635Y+W5omA5pyJ55So5oi355qE6aKR6YGT5YiX6KGoICovDQogICAgICB0cnkgew0KICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGNoYW5uZWxBbGxMaXN0KCkNCiAgICAgICAgdGhpcy5hbGxjaGFubmVscyA9IGRhdGEuZGF0YS5jaGFubmVscw0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgdGhpcy4kdG9hc3QoJ+iOt+aJgOaciemikemBk+Wksei0pe+8gScpDQogICAgICB9DQogICAgfSwNCiAgICBhc3luYyBhZGRDaGFubmVsIChjaGFubmVsTmFtZSkgew0KICAgICAgLyog5Li65re75Yqg55So5oi36aKR6YGTICovDQogICAgICB0aGlzLm15Q2hhbm5lbHMucHVzaChjaGFubmVsTmFtZSkNCiAgICAgIC8vIOaVsOaNruaMgeS5heWMlg0KICAgICAgaWYgKHRoaXMudXNlcikgew0KICAgICAgICAvLyDnlKjmiLflt7LnmbvlvZXnirbmgIEs5bCG6K+35rGC5o6l5Y+j5pS+5Zyo57q/5LiKDQogICAgICAgIHRyeSB7DQogICAgICAgICAgYXdhaXQgYWRkVXNlckNoYW5uZWwoew0KICAgICAgICAgICAgaWQ6IGNoYW5uZWxOYW1lLmlkLA0KICAgICAgICAgICAgc2VxOiB0aGlzLm15Q2hhbm5lbHMubGVuZ3RoDQogICAgICAgICAgfSkNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICB0aGlzLiR0b2FzdCgn5L+d5a2Y5aSx6LSl77yM6K+356iN5ZCO6YeN6K+VJykNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgLy8g5pyq55m75b2V77yM5bCG5pWw5o2u5a2Y5YKo5Yiw5pys5ZywDQogICAgICAgIHNldEl0ZW0oJ1RPVVRJQU9fQ0hBTk5FTFMnLCB0aGlzLm15Q2hhbm5lbHMpDQogICAgICB9DQogICAgfSwNCiAgICBzaG93RWRpdCAoKSB7DQogICAgICAvKiDliKDpmaTmjInplK7nmoTmmL7npLrkuI7pmpDol48gKi8NCiAgICAgIHRoaXMuaXNlZGl0ID0gIXRoaXMuaXNlZGl0DQogICAgfSwNCiAgICBvbk15Q2hhbm5lbGxpY2sgKGNoYW5uZWwsIGluZGV4KSB7DQogICAgICAvKiDliKDpmaTnlKjmiLfpopHpgZMgKi8NCiAgICAgIGlmICh0aGlzLmlzZWRpdCkgew0KICAgICAgICBpZiAodGhpcy5maXhJdGVtLmluY2x1ZGVzKGNoYW5uZWwuaWQpKSB7DQogICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCiAgICAgICAgdGhpcy5teUNoYW5uZWxzLnNwbGljZShpbmRleCwgMSkNCiAgICAgICAgY29uc29sZS5sb2coaW5kZXgsIHRoaXMubXlBY3RpdmUpDQogICAgICAgIGlmIChpbmRleCA8PSB0aGlzLm15QWN0aXZlKSB7DQogICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlLWFjdGl2ZScsIGluZGV4LCB0cnVlKQ0KICAgICAgICB9DQogICAgICAgIC8vIOaVsOaNruaMgeS5heWMlg0KICAgICAgICB0aGlzLmRlbGV0ZUNoYW5uZWwoY2hhbm5lbCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZS1hY3RpdmUnLCBpbmRleCwgZmFsc2UpDQogICAgICB9DQogICAgfSwNCiAgICBhc3luYyBkZWxldGVDaGFubmVsIChjaGFubmVsKSB7DQogICAgICAvKiDlsIbliKDpmaTnmoTmlbDmja4gKi8NCiAgICAgIHRyeSB7DQogICAgICAgIGlmICh0aGlzLnVzZXIpIHsNCiAgICAgICAgICAvLyDlt7LnmbvlvZXvvIzlsIbmlbDmja7mm7TmlrDliLDnur/kuIoNCiAgICAgICAgICBhd2FpdCBkZWxldGNVc2VyQ2hhbm5lbChjaGFubmVsLmlkKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIC8vIOacqueZu+W9leWwhuaVsOaNruWtmOWCqOWIsOacrOWcsA0KICAgICAgICAgIHNldEl0ZW0oJ1RPVVRJQU9fQ0hBTk5FTFMnLCB0aGlzLm15Q2hhbm5lbHMpDQogICAgICAgIH0NCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIHRoaXMuJHRvYXN0KCfliKDpmaTnlKjmiLfliJfooajlpLHotKXvvIzor7fnqI3lkI7ph43or5UnKQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgLy8g55Sf5ZG95ZGo5pyfIC0g5Yib5bu65a6M5oiQ77yI5Y+v5Lul6K6/6Zeu5b2T5YmNdGhpc+WunuS+i++8iQ0KICBjcmVhdGVkICgpIHsNCiAgICB0aGlzLmxvYWRBbGxDaGFubmVscygpDQogIH0sDQogIC8vIOeUn+WRveWRqOacnyAtIOaMgui9veWujOaIkO+8iOWPr+S7peiuv+mXrkRPTeWFg+e0oO+8iQ0KICBtb3VudGVkICgpIHt9LA0KICBiZWZvcmVDcmVhdGUgKCkge30sIC8vIOeUn+WRveWRqOacnyAtIOWIm+W7uuS5i+WJjQ0KICBiZWZvcmVNb3VudCAoKSB7fSwgLy8g55Sf5ZG95ZGo5pyfIC0g5oyC6L295LmL5YmNDQogIGJlZm9yZVVwZGF0ZSAoKSB7fSwgLy8g55Sf5ZG95ZGo5pyfIC0g5pu05paw5LmL5YmNDQogIHVwZGF0ZWQgKCkge30sIC8vIOeUn+WRveWRqOacnyAtIOabtOaWsOS5i+WQjg0KICBiZWZvcmVEZXN0cm95ICgpIHt9LCAvLyDnlJ/lkb3lkajmnJ8gLSDplIDmr4HkuYvliY0NCiAgZGVzdHJveWVkICgpIHt9LCAvLyDnlJ/lkb3lkajmnJ8gLSDplIDmr4HlrozmiJANCiAgYWN0aXZhdGVkICgpIHt9IC8vIOWmguaenOmhtemdouaciWtlZXAtYWxpdmXnvJPlrZjlip/og73vvIzov5nkuKrlh73mlbDkvJrop6blj5ENCn0NCg=="},{"version":3,"sources":["channel-edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"channel-edit.vue","sourceRoot":"src/views/home/components","sourcesContent":["<template>\r\n  <div class=\"channel-edit\">\r\n    <!-- 我的频道 -->\r\n    <van-cell :border=\"false\">\r\n      <div slot=\"title\" class=\"title-text\">我的频道</div>\r\n      <van-button round type=\"danger\" plain size=\"mini\" class=\"edit-btn\" @click=\"showEdit\">{{isedit ?  \"完成\" : \"编辑\"}}</van-button>\r\n    </van-cell>\r\n    <!-- 我的频道宫格板块 -->\r\n    <van-grid class=\"my-grid\" :gutter=\"10\">\r\n      <van-grid-item  v-for=\"(item,index) in myChannels\" :key=\"index\"  class=\"grid-item\">\r\n        <van-icon slot=\"icon\" name=\"clear\"  @click=\"onMyChannellick(item, index)\" v-show=\"isedit  && !fixItem.includes(item.id)\"></van-icon>\r\n        <span slot=\"text\" :class=\"{ active: index === myActive }\" class=\"text\">{{item.name}}</span>\r\n      </van-grid-item>\r\n    </van-grid>\r\n\r\n    <!-- 频道推荐列表 -->\r\n    <van-cell :border=\"false\">\r\n      <div slot=\"title\" class=\"title-text\">频道推荐</div>\r\n    </van-cell>\r\n    <!-- 频道推荐宫格板块 -->\r\n    <van-grid :gutter=\"10\" class=\"recommend-item\">\r\n      <van-grid-item v-for=\"(value, index) in recommendChannels\" :key=\"index\" icon=\"plus\" class=\"grid-item\" :text=\"value.name\" @click=\"addChannel(value)\"/>\r\n    </van-grid>\r\n  </div>\r\n</template>\r\n<script>\r\n// 这里可以导入其他文件（比如：组件，工具js，第三方插件js，json文件，图片文件等等）\r\nimport { channelAllList, addUserChannel, deletcUserChannel } from '@/api/channel.js'\r\nimport { mapState } from 'vuex'\r\nimport { setItem } from '@/utils/storage'\r\nexport default {\r\n  components: {},\r\n  // 定义属性\r\n  props: {\r\n    myChannels: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    myActive: {\r\n      type: Number,\r\n      required: true\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      allchannels: [], // 所有频道\r\n      isedit: false, // 删除按键的显示与隐藏\r\n      fixItem: [0] // 固定不要删除的频道\r\n    }\r\n  },\r\n  // 计算属性，会监听依赖属性值随之变化\r\n  computed: {\r\n    ...mapState(['user']),\r\n    recommendChannels () {\r\n      /* 推荐频道数据 */\r\n      const channels = []\r\n      this.allchannels.forEach(channel => {\r\n        // 遍历所有频道，并将属于个人频道的数据剔除，并返回剩下的频道\r\n        const ret = this.myChannels.find(mychannel => {\r\n          return mychannel.id === channel.id\r\n        })\r\n        if (!ret) {\r\n          channels.push(channel)\r\n        }\r\n      })\r\n      return channels\r\n    }\r\n  },\r\n  // 监控data中的数据变化\r\n  watch: {},\r\n  // 方法集合\r\n  methods: {\r\n    async loadAllChannels () {\r\n      /* 获取所有用户的频道列表 */\r\n      try {\r\n        const { data } = await channelAllList()\r\n        this.allchannels = data.data.channels\r\n      } catch (error) {\r\n        this.$toast('获所有频道失败！')\r\n      }\r\n    },\r\n    async addChannel (channelName) {\r\n      /* 为添加用户频道 */\r\n      this.myChannels.push(channelName)\r\n      // 数据持久化\r\n      if (this.user) {\r\n        // 用户已登录状态,将请求接口放在线上\r\n        try {\r\n          await addUserChannel({\r\n            id: channelName.id,\r\n            seq: this.myChannels.length\r\n          })\r\n        } catch (error) {\r\n          this.$toast('保存失败，请稍后重试')\r\n        }\r\n      } else {\r\n        // 未登录，将数据存储到本地\r\n        setItem('TOUTIAO_CHANNELS', this.myChannels)\r\n      }\r\n    },\r\n    showEdit () {\r\n      /* 删除按键的显示与隐藏 */\r\n      this.isedit = !this.isedit\r\n    },\r\n    onMyChannellick (channel, index) {\r\n      /* 删除用户频道 */\r\n      if (this.isedit) {\r\n        if (this.fixItem.includes(channel.id)) {\r\n          return\r\n        }\r\n        this.myChannels.splice(index, 1)\r\n        console.log(index, this.myActive)\r\n        if (index <= this.myActive) {\r\n          this.$emit('update-active', index, true)\r\n        }\r\n        // 数据持久化\r\n        this.deleteChannel(channel)\r\n      } else {\r\n        this.$emit('update-active', index, false)\r\n      }\r\n    },\r\n    async deleteChannel (channel) {\r\n      /* 将删除的数据 */\r\n      try {\r\n        if (this.user) {\r\n          // 已登录，将数据更新到线上\r\n          await deletcUserChannel(channel.id)\r\n        } else {\r\n          // 未登录将数据存储到本地\r\n          setItem('TOUTIAO_CHANNELS', this.myChannels)\r\n        }\r\n      } catch (error) {\r\n        this.$toast('删除用户列表失败，请稍后重试')\r\n      }\r\n    }\r\n  },\r\n  // 生命周期 - 创建完成（可以访问当前this实例）\r\n  created () {\r\n    this.loadAllChannels()\r\n  },\r\n  // 生命周期 - 挂载完成（可以访问DOM元素）\r\n  mounted () {},\r\n  beforeCreate () {}, // 生命周期 - 创建之前\r\n  beforeMount () {}, // 生命周期 - 挂载之前\r\n  beforeUpdate () {}, // 生命周期 - 更新之前\r\n  updated () {}, // 生命周期 - 更新之后\r\n  beforeDestroy () {}, // 生命周期 - 销毁之前\r\n  destroyed () {}, // 生命周期 - 销毁完成\r\n  activated () {} // 如果页面有keep-alive缓存功能，这个函数会触发\r\n}\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n.channel-edit{\r\n  padding:85px 0;\r\n  .title-text{\r\n    font-size: 32px;\r\n    color: #333;\r\n  }\r\n  .edit-btn{\r\n    width: 104px;\r\n    height: 48px;\r\n    font-size: 26px;\r\n    color:#f85959;\r\n    border:1px solid #f85959;\r\n  }\r\n  /deep/ .grid-item{\r\n    width: 160px;\r\n    height: 86px;\r\n    .van-grid-item__content{\r\n      background-color: #f4f5f6;\r\n      white-space: nowrap;\r\n      display: flex;\r\n      flex-direction: row;\r\n      justify-content:center;\r\n      align-items: center;\r\n      .van-grid-item__icon-wrapper{\r\n        position: unset;\r\n      }\r\n      .van-grid-item__text, .text{\r\n        font-size: 28px;\r\n        color:#222;\r\n        margin-top:0;\r\n      }\r\n      .active  {\r\n        color:red;\r\n      }\r\n      .van-icon-clear{\r\n        position:absolute;\r\n        top: -10px;\r\n        right:-10px;\r\n        color: #cacaca;\r\n        z-index: 2;\r\n        font-size: 30px;\r\n      }\r\n      .van-grid-item__icon{\r\n        font-size: 24px;\r\n        margin-right:15px;\r\n      }\r\n      .van-grid-item__text{\r\n        font-size: 28px;\r\n        color:#222;\r\n        margin-top: 0;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}